---
title: "Exploring openWAR"
author: "Ben Baumer"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

In this vignette we will explore some of the tabulated results of `openWAR`. Please note that due to their size, the full play-by-play results are distributed in the [`openWARData` package](https://github.com/beanumber/openWARData). 

```{r}
library(openWAR)
```

We have included the pre-computed results of openWAR for the 2012-2014 seasons in the `openWAR` package. For example, the `openWAR2012` data frame contains openWAR values for `r nrow(openWAR2012)` players. 


```{r, fig.width=6, fig.height=6}
data(openWAR2012)
```

Generic functions for `summary()` and `plot()` have been written to help summarize these results. `summary()` will print the top 25 performers in terms of `openWAR`. This function also accepts an `n` argument that is passed to `head()`. Note that [Mike Trout](http://en.wikipedia.org/wiki/Mike_Trout) led all of baseball in `openWAR` in each of these three seasons. 

```{r, fig.width=6, fig.height=6}
summary(openWAR2012)
summary(openWAR2013, n = 10)
summary(openWAR2014, n = 5)
```

The `plot()` function provides a scatterplot openWAR Runs Above Average (`RAA`) against combined playing time (plate appearances and batters faced). The $30 \cdot 25 = 750$ players who played the most (390 position players and 360 pitchers) are designated as "MLB Players", while the remaining players are designated as *replacement* players. The average performance of these players defines the baseline for replacement-level players. In the plot, each blue or pink dot represents the performance of an actual player. Each of those players has an associated grey dot with the same horizontal coordinate (e.g. the same amount of playing time). These grey dots are the *replacement-level shadows* of the real players, and their vertical coordinates are the expected performance of that replacement-level player. Each player's `RAA` (and thus `WAR`) is realized as the vertical distance between each player and his replacement-level shadow. 

```{r, fig.width=6, fig.height=6}
plot(openWAR2012)
```

In 2012, we can see that Mike Trout was the best position player, Clayton Kershaw was the best pitcher, and Nick Blackburn was the worst player. 

```{r, fig.width=6, fig.height=6}
plot(openWAR2013)
plot(openWAR2014)
```

Note that is all three years, the sum of `RAA` is exactly 0 -- this is guaranteed by the `openWAR` model. The total amount of `WAR` is a measure of how much better, collectively, the MLB players were than the replacment-level players. 

```{r, message=FALSE}
library(mosaic)
sum(~RAA, data=openWAR2012)
sum(~WAR, data=openWAR2012)
sum(~repl, data=openWAR2012)
sum(RAA ~ isReplacement, data=openWAR2012)
sum(RAA ~ isReplacement, data=openWAR2013)
sum(RAA ~ isReplacement, data=openWAR2014)
```

[Jose Molina](http://en.wikipedia.org/wiki/Jos%C3%A9_Molina_(baseball))'s had the lowest `WAR` in 2014. Currently, openWAR does not measure the value of catcher framing, an attribute at which [Molina excels](http://grantland.com/features/studying-art-pitch-framing-catchers-such-francisco-cervelli-chris-stewart-jose-molina-others/). 

The fielding `RAA` values in openWAR are separated by position, so that, for example, you can isolate all players who saved at least one run above average at both second base and shortstop. 

```{r}
openWAR2012 %>%
  filter(RAA.SS > 1 & RAA.2B > 1) %>%
  select(Name, TPA, RAA.SS, RAA.2B, WAR) %>%
  arrange(desc(WAR))
```

Because `WAR` is a counting stat, it may make sense to consider `WAR` accumulated relative to playing time. In 2012, [Joey Votto](http://en.wikipedia.org/wiki/Joey_Votto) had a higher `openWAR` per plate appearance than Mike Trout, and Craig Kimbrel was the most effective pitcher per batter faced. 

```{r}
openWAR2012 %>%
  filter(TPA > 200) %>%
  mutate(WARpa = WAR/TPA) %>%
  select(Name, TPA, WAR, WARpa, RAA.bat, RAA.br, RAA.field, RAA.pitch) %>%
  arrange(desc(WARpa)) %>%
  head(10)
```



### Reference for the openWAR model

For a complete description of the openWAR model, please see our paper on the subject:

* Benjamin S. Baumer, Gregory J. Matthews, Shane T. Jensen. 2013. "OpenWAR: An Open Source System for Evaluating Overall Player Performance in Major League Baseball." *Journal of Quantitative Analysis in Sports*, 11(2), (http://arxiv.org/abs/1312.7158v3).
